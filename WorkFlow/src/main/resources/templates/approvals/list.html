<!DOCTYPE html>
<html xmlns="http://www.thymeleaf.org" xmlns:layout="http://www.ultrap.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">

<head>
	<title>申請承認画面</title>
	<link rel="stylesheet" th:href="@{/css/user/list.css}">
	<script th:src="@{/js/appList.js}" defer></script>
</head>

<body layout:fragment="content">

	<select id="status-filter">
		<option value="ALL">すべて</option>
		<option value="PENDING">未承認</option>
		<option value="APPROVED">承認済</option>
		<option value="REJECTED">却下済</option>
		<option value="REMAND">差し戻し</option>
	</select>

	<div class="container" style="display: flex;">
		<div th:if="${message}" style="color: green; font-weight: bold; margin-bottom: 10px;">
			<p th:text="${message}">承認メッセージ表示</p>
		</div>

		<table class="table table-striped table-bordered table-hover" id="requests-table">
			<thead>
				<tr>
					<th class="th-width">ユーザー名</th>
					<th class="th-width">申請種別</th>
					<th class="th-width">対象日</th>
					<th class="th-width">提出日</th>
					<th class="th-width">ステータス</th>
					<th class="th-width">操作</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="r : ${requests}" th:attr="data-status=${r.status.name()}">
					<td th:text="${r.userName}"></td>
					<td th:text="${r.kindLabel}"></td>
					<td th:text="${r.targetDate}"></td>
					<td th:text="${#temporals.format(r.submittedAt,'yyyy-MM-dd HH:mm')}"></td>
					<td th:text="${r.statusLabel}"></td>
					<td>
						<form th:if="${r.status.name() == 'PENDING'}" action="/approvals/approve" method="post"
							style="display:inline;">
							<input type="hidden" name="requestId" th:value="${r.id}">
							<button type="submit" name="decision" value="APPROVED">承認</button>
							<button type="submit" name="decision" value="REJECTED">却下</button>
							<button type="submit" name="decision" value="REMAND">差し戻し</button>
						</form>
						<span th:if="${r.status.name() != 'PENDING'}" th:text="${'処理済: ' + r.statusLabel}"></span>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</body>

</html>