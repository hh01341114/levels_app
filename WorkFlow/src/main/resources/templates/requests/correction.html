<!DOCTYPE html>
<html xmlns="http://www.thymeleaf.org" xmlns:layout="http://www.ultrap.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">

<head>
	<title>勤怠修正申請</title>
	<link rel="stylesheet" th:href="@{/css/user/list.css}">
	<script th:src="@{/js/correction.js}" defer></script>
</head>

<body layout:fragment="content">
	<h2>勤怠修正申請フォーム</h2>

	<form th:action="@{/requests/correction}" th:object="${requestForm}" method="post">
		<label>修正対象日：</label>
		<input type="date" th:field="*{targetDate}"><br><br>

		<label>申請内容・理由：</label><br>
		<textarea th:field="*{comment}" rows="4" cols="40"></textarea><br><br>

		<button type="submit">申請する</button>
	</form>

	<hr>

	<h3>申請履歴（勤怠修正）</h3>
	<!-- トグルボタン -->
	<select id="status-filter">
		<option value="ALL">すべて</option>
		<option value="PENDING">未承認</option>
		<option value="APPROVED">承認済</option>
		<option value="REJECTED">却下済</option>
		<option value="REMAND">差し戻し</option>
	</select>

	<!-- テーブル（ステータスごとに表示切り替え） -->
	<table border="1" id="correction-table">
		<thead>
			<tr>
				<th>申請日</th>
				<th>対象日</th>
				<th>理由</th>
				<th>ステータス</th>
			</tr>
		</thead>
		<tbody>
			<!-- 未承認 -->
			<tr th:each="request : ${pendingList}" th:attr="data-status=${request.status}">
				<td th:text="${#temporals.format(request.submittedAt, 'yyyy-MM-dd HH:mm')}"></td>
				<td th:text="${request.targetDate}"></td>
				<td th:text="${request.comment}"></td>
				<td th:text="${request.status.label}"></td>
			</tr>

			<!-- 承認済 -->
			<tr th:each="request : ${approvedList}" th:attr="data-status=${request.status}">
				<td th:text="${#temporals.format(request.submittedAt, 'yyyy-MM-dd HH:mm')}"></td>
				<td th:text="${request.targetDate}"></td>
				<td th:text="${request.comment}"></td>
				<td th:text="${request.status.label}"></td>
			</tr>

			<!-- 却下済 -->
			<tr th:each="request : ${rejectedList}" th:attr="data-status=${request.status}">
				<td th:text="${#temporals.format(request.submittedAt, 'yyyy-MM-dd HH:mm')}"></td>
				<td th:text="${request.targetDate}"></td>
				<td th:text="${request.comment}"></td>
				<td th:text="${request.status.label}"></td>
			</tr>

			<!-- 差し戻し -->
			<tr th:each="request : ${remandList}" th:attr="data-status=${request.status}">
				<td th:text="${#temporals.format(request.submittedAt, 'yyyy-MM-dd HH:mm')}"></td>
				<td th:text="${request.targetDate}"></td>
				<td th:text="${request.comment}"></td>
				<td th:text="${request.status.label}"></td>
			</tr>
		</tbody>
	</table>
</body>

</html>