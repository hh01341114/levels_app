<!DOCTYPE html>
<html xmlns="http://www.thymeleaf.org" xmlns:layout="http://www.ultrap.net.nz/thymeleaf/layout" layout:decorate="~{layout/layout}">
	
<head>
	<title>各種申請画面</title>
	<link rel="stylesheet" th:href="@{/css/user/list.css}">
	<script>
		function showTab(tabName) {
			const tabs = ['pending', 'approved', 'rejected', 'remand'];
			tabs.forEach(tab => {
				document.getElementById(tab + '-table').style.display = (tab === tabName) ? 'table' : 'none';
				document.getElementById(tab + '-btn').classList.toggle('active', tab === tabName);
			});
		}
	</script>
	<style>
		.tab-button {
			margin-right: 10px;
			padding: 5px 10px;
			cursor: pointer;
		}
		.tab-button.active {
			background-color: #007bff;
			color: white;
			border-radius: 5px;
		}
	</style>
</head>
<body layout:fragment="content">
		<h2>有給申請フォーム</h2>

		<form th:action="@{/requests/paidleave}" th:object="${requestForm}" method="post">
			<label>対象日：</label>
			<input type="date" th:field="*{targetDate}" /><br><br>

			<label>申請理由：</label><br>
			<textarea th:field="*{comment}" rows="4" cols="40"></textarea><br><br>

			<button type="submit">申請する</button>
		</form>

		<hr>

		<h3>申請履歴（有給）</h3>

		<!-- トグルボタン -->
		<details>
			<summary>申請状況</summary>
				<button class="tab-button active" id="pending-btn" onclick="showTab('pending')">未承認</button><br/>
				<button class="tab-button" id="approved-btn" onclick="showTab('approved')">承認済</button><br/>
				<button class="tab-button" id="rejected-btn" onclick="showTab('rejected')">却下</button><br/>
				<button class="tab-button" id="remand-btn" onclick="showTab('remand')">差戻し</button><br/>
		</details>
		
		<!-- テーブル（ステータスごとに表示切り替え） -->
		<table border="1" id="pending-table">
			<tr><th>申請日</th><th>対象日</th><th>理由</th><th>ステータス</th></tr>
			<tr th:each="request : ${pendingList}">
				<td th:text="${#temporals.format(request.submittedAt, 'yyyy-MM-dd HH:mm')}"></td>
				<td th:text="${request.targetDate}"></td>
				<td th:text="${request.comment}"></td>
				<td th:text="${request.status}"></td>
			</tr>
		</table>

		<table border="1" id="approved-table" style="display:none;">
			<tr><th>申請日</th><th>対象日</th><th>理由</th><th>ステータス</th></tr>
			<tr th:each="request : ${approvedList}">
				<td th:text="${#temporals.format(request.submittedAt, 'yyyy-MM-dd HH:mm')}"></td>
				<td th:text="${request.targetDate}"></td>
				<td th:text="${request.comment}"></td>
				<td th:text="${request.status}"></td>
			</tr>
		</table>

		<table border="1" id="rejected-table" style="display:none;">
			<tr><th>申請日</th><th>対象日</th><th>理由</th><th>ステータス</th></tr>
			<tr th:each="request : ${rejectedList}">
				<td th:text="${#temporals.format(request.submittedAt, 'yyyy-MM-dd HH:mm')}"></td>
				<td th:text="${request.targetDate}"></td>
				<td th:text="${request.comment}"></td>
				<td th:text="${request.status}"></td>
			</tr>
		</table>

		<table border="1" id="remand-table" style="display:none;">
			<tr><th>申請日</th><th>対象日</th><th>理由</th><th>ステータス</th></tr>
			<tr th:each="request : ${remandList}">
				<td th:text="${#temporals.format(request.submittedAt, 'yyyy-MM-dd HH:mm')}"></td>
				<td th:text="${request.targetDate}"></td>
				<td th:text="${request.comment}"></td>
				<td th:text="${request.status}"></td>
			</tr>
		</table>
	</body>
</html>